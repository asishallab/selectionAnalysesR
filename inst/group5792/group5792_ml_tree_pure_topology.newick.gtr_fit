#NEXUS

BEGIN TAXA;
	DIMENSIONS NTAX = 4;
	TAXLABELS
		'PROT1' 'PROT3' 'PROT4' 'PROT5' ;
END;

BEGIN CHARACTERS;
	DIMENSIONS NCHAR = 1035;
	FORMAT
		DATATYPE = DNA
		GAP=-
		MISSING=?
	;

MATRIX
	'PROT1'  ATGGCTGAGTCTAGCAAGTTATCCGCAACCACAGTTGAAGCAGCTCCTGCTATGATTAAGGCCAAAGACGTGATTTCTCCTTCCGAGAAGGAAGAATCTGATCAGACGGAGATCACGAAAGTATCCGTCTTG------------------AAAAACCTTGATGAGAAGGAGATGATCAAAGAATTCGCTGATCGTCTTCAGCGTCTCGAAGCAAAGGTGGATTTGTTGGTAACAAAGGCGGATTTGTTGGCAATAAAGGCGGATATACAGGAGCTTCTCATCTCAGCCAAGGGTGAGAAAGTTCCTGCCATGAAGACTTCTGCTAAGGCTTCTTCTGAGAGCGATGAC---TCATACATGGACACTTCTTCGGAGGATGAATCGTCTTCTGCTGAGGAACCTGTAAACAAACCTGCTGCAAGTGCCGCCAAGCCAGCTACTAAAGATTCTTTATTCTCTGCTGGTTTCAAGCCAGCTGCTAAAGATTCTTTATTCTCTGCTGGTTTCAAGCCAGATTCTTTATTCTCTGCTGGTTTCGAGCCAGCTGCTAAAGATTCTTTATTCTCTGCTGGTTTCAAGCCAGGTTCTTTATTCTCTGCTGGTTTCGAGCCAGCTGCTAAAGATTCTTTATTCTCTGCTGGTTTCAAGCCAGATTCTTTATTCTCTGTTGGTGTCAAGCCAGCTGCTAAAGATTCTTTATTTTCTGTTGGTGTCAATGGTCGATCGTTCTCTGTTACGGGATTTGACGCTTCCCTTCCTGTGGATGATATAAAGAGCGCATTGAGTAAATATTTCAGTTCTTTTGGGGAGATCACACGCGTATTTGTTCCCCCAAGCCACGGAACCGGTGGTTCCTTAGGATATGCTTACATTGATCTGAAAGAAGGAGCAGAGAAGGCGTTGGAACTTGGTAGA---CATGACGTG------GGAGGATGGGATCTTGTAGTTGGTAAGGCTGAACCGATTCGCAGTGGAAGTACTTGGCCTTTTCCTGGCCGTTGTGGTAATCAGGGCCGTTGTACCTTCTGT
	'PROT3'  ATGGCCGGGTCTAGCAAGAAATCCGCAACCAAAGGTGAATCAACTCCTGCTTTGATTAAGGCCACCAAGTCTGTGAAAAAGTCCAAGAGGAAGCAGGAAGATGATTCAAAGAGGCCAAAGAAAGACGTAACGATTGCTCCTCTCAAGAAGAAGAAATCTGGGAGGAAGAAGATCATGAAGGAAATCGTTGATCGTCTTCAAAGGCTCGAAGCTAAGATGGATTTGCTGGCAACAAAGGCGGATCTAGAGGCGATT---------------------TTGATCTCAGCCAAGGGTGAGAAAGTTCCTGCCATAAAGCCTCCTGCTAAGGCTGCGTCTGACAGCGAGGACTCATCATACATGGACACTTCTTCAGATGAACAAGTTACTGTATCCAAGAATCCACATGCAGCTGCTAAAAAGGTCTCTGTAAAGGCCAAAACAGAGAACAGT---------------------TCGTCTCAGGATGATTCA------------------------------------TCTTCTGATGAGGAACCTGTAAATAATCCTGCTGCGTTTACC------------------------------------------------------------------------------------------------------------AAACCAGCTGCTAAACATTCTCCATCCTCAATTGGTGACAATCCTCAAACGATCTCTGTTACAGGATTTGACCCTTCGATCCATGTGGATGATGTCAACATCATATTGAGTAGATATTTCAGTTCTTTTGGGGAGATCACACGCGTATTTGTTCCCGCAGACGGTGACACCGATGCTTCCTTAGGATATGCTTACATTGATCTGAAACAAGGAGCAGACAAGGCGTTGAAAATTGCCAGA---CATGACGTG------GGAGGATGGAATCTTGTAGTTGGTACGGCTGAACCAATACAAAGTGGTAGT---TGGCTTTTTAACGGCCGTTGTGGCTCTCGTGGCTTCTGTGGGTACTGT
	'PROT4'  ATGGCCGAGTCTAGCAAGAATTACGTGACCAAA---------------------------------------------------------------------------------------------------------------------------TTCGAGATGAAGGAAATGGTGGAAGGAATCGCTGATCGTCTTCAGCGGATCGAAGCAATGTTGGATTTGTTGGTAACAAAA---------------------------------------------------AAGGGTGAGAAA---------------------------------------------------------------GGCAGCGAGGATGGTGAAGTTAGTGCAACCAAGAAGCCA---------------------GATGTAAAGGCGGAGACAGAGAAC---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------CCTTTTGCTAAGGATTCTTCATCCTCTGGTGGTGGCAATGGTCAAACTATCTCCGTTACGGGATTCGACCCTTCGCTTCCTCTGGGTTATATCGAGTCTGAATTGACTAAATATTTCGGTTCGTTTGGAGAGATCACACGCGTATTTGTTCCCGCAGACACTTTAACAGGTATTTCTTTGGGTTATGCTTACATTGATATGAAAGAAGGCGCAGAGAAGGCGTTGGAACTTGGTGTA---GTTAATCTGCCGAGAGGAGGTTAT---CTTGTAATTGGCAAGGCTGAACCAATAGCCAGTGGAAGTAGTTGGCCTTATCCCGGCCGATGTGGCAATCAAGGCCGCTGTACCTTCTGT
	'PROT5'  ATGGCCGAGTCTAGCAAGACTTCCGCAACCAAAGGTGAAGCAGCTCCTGCTGTGATTAAGGCGACAAAGCCTTTGGAGAAAGATACGAGGCAGCCGGAAGATAATGATTCAGAGACCAAAGTAGATCTGACGAAGCAGAAGATAGACGTGTTCATATCCGAGATGAAGGAGATGATGGAAGGATTCGCTGATCGTTTTCAGCGGCTCGAATCAAAGGTGGATTCGCTGGCAACAAAGGCTGAT---CAGGCGATT---------------------TTGATCTTAGCGAAGGGTAAGAAAGTTCCTGCTTAT---------------------------AACGGTGAGGTCTCGTCCATGGACACTTCATCAGATGAAGAAGTTACTGTAACCAAGAAGCCTAATGCAGCTGCTAAAATAGTATCTTTCAAGGCCATGACAAATAACAGT---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------TTCCCCAGTTTTAACAGTGACAATGGTCAAACGTTAGCCGTTAGGGGATTTGACTATTCGCTAGACGTGGATTATATCAAGACTGCATTGACTAACCATTTTGGTAAATTTGGAGAGATCACACGCGTATTTGTTCCCACAGACCGTTTCACGGGTGCTTGCTTAGGATATGCTTACGTTGATCAGAAAGAAGGCGCAGACAAGGCGTTGAGACTTGGTGGTGTGATTAACATG------GGAGGACGTAATCTTAATGTTGACAGAGCTGAACCGATACGCAGTCCAAGTACTTGGCCTTTTCAAGGCCGTTGTGGCAATCAAGGCTTTTGTGCAACCTGT;
END;

BEGIN HYPHY;


global AC=0.7113781604163166;
global AT=0.6231354780303934;
global CG=0.6254167136570984;
global CT=0.8079007932566318;
global GT=0.4646985386553214;
GRM={4,4};
GRM[0][1]:=AC*mu;
GRM[0][2]:=mu;
GRM[0][3]:=AT*mu;
GRM[1][0]:=AC*mu;
GRM[1][2]:=CG*mu;
GRM[1][3]:=CT*mu;
GRM[2][0]:=mu;
GRM[2][1]:=CG*mu;
GRM[2][3]:=GT*mu;
GRM[3][0]:=AT*mu;
GRM[3][1]:=CT*mu;
GRM[3][2]:=GT*mu;


vectorOfFrequencies={
{0.2670893719806763}
{0.2125}
{0.2547705314009662}
{0.2656400966183575}
}
;
Model GRMModel=(GRM,vectorOfFrequencies);
TRY_NUMERIC_SEQUENCE_MATCH=0;
ACCEPT_ROOTED_TREES=0;

UseModel (GRMModel);
Tree nuc_tree_1=(PROT1,PROT4,(PROT3,PROT5)Node3);

nuc_tree_1.PROT1.mu=0.388852837616793;
nuc_tree_1.PROT4.mu=0.2686695978017023;
nuc_tree_1.PROT3.mu=0.2698142881012332;
nuc_tree_1.PROT5.mu=0.3615050984181373;
nuc_tree_1.Node3.mu=0.101498895898985;
DataSet ds_1 = ReadDataFile(USE_NEXUS_FILE_DATA);
DataSetFilter nucData_1 = CreateFilter(ds_1,1,"0-1034","0,2,1,3");
ASSUME_REVERSIBLE_MODELS=0;
LikelihoodFunction nucLF = (nucData_1,nuc_tree_1);positionalFrequencies = {
{0.276268115942029,0.2965579710144928,0.2284420289855073}
{0.1588768115942029,0.2813405797101449,0.1972826086956522}
{0.348731884057971,0.1827898550724638,0.2327898550724638}
{0.2161231884057971,0.2393115942028985,0.3414855072463768}
}
;

END;